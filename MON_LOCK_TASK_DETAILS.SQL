SELECT "LOCK"."APPLICATION_ID" AS "APPLICATION",
	"LOCK"."SPACE_ID" AS "SPACE",
	"LOCK"."OBJECT_ID" AS "OBJECT",
	"LOCK"."TASK_LOG_ID" AS "LOCK_TASK_ID",
	"LOCK"."CREATION_TIME" AS "LOCK_CREATION_TIME",
	"LOGS"."TASK_LOG_ID" AS "LOG_TASK_ID",
	"LOGS"."START_TIME" AS "LOG_START_TIME",
	"MSG"."MESSAGE_NO" AS "LOG_MESSAGE_NO",
	"MSG"."SEVERITY" AS "MSG_SEVERITY",
	"MSG"."TEXT" AS "MSG_TEXT",
	"MSG"."DETAILS" AS "MSG_DETAILS",
	1 AS "COUNTER"
FROM "TASK_LOCKS_V_EXT" AS "LOCK"
	LEFT OUTER JOIN "TASK_LOGS_V_EXT" AS "LOGS" ON "LOCK"."APPLICATION_ID" = "LOGS"."APPLICATION_ID" AND "LOCK"."SPACE_ID" = "LOGS"."SPACE_ID" AND "LOCK"."OBJECT_ID" = "LOGS"."OBJECT_ID"
	LEFT OUTER JOIN "TASK_LOG_MESSAGES_V_EXT" AS "MSG" ON "LOGS"."TASK_LOG_ID" = "MSG"."TASK_LOG_ID"
WHERE "LOGS"."STATUS" = 'FAILED'
	AND "LOGS"."TASK_LOG_ID" = (
		SELECT MAX("LOGS_MAX"."TASK_LOG_ID")
		FROM "TASK_LOGS_V_EXT" AS "LOGS_MAX"
		WHERE "LOGS_MAX"."STATUS" = 'FAILED'
			AND "LOCK"."APPLICATION_ID" = "LOGS_MAX"."APPLICATION_ID"
			AND "LOCK"."SPACE_ID" = "LOGS_MAX"."SPACE_ID"
			AND "LOCK"."OBJECT_ID" = "LOGS_MAX"."OBJECT_ID"
	)
GROUP BY "LOCK"."APPLICATION_ID",
	"LOCK"."SPACE_ID",
	"LOCK"."OBJECT_ID",
	"LOCK"."TASK_LOG_ID",
	"LOCK"."CREATION_TIME",
	"LOGS"."TASK_LOG_ID",
	"LOGS"."START_TIME",
	"MSG"."MESSAGE_NO",
	"MSG"."SEVERITY",
	"MSG"."TEXT",
	"MSG"."DETAILS"
ORDER BY "LOCK"."APPLICATION_ID",
	"LOCK"."SPACE_ID",
	"LOCK"."OBJECT_ID",
	"LOCK"."TASK_LOG_ID",
	"LOCK"."CREATION_TIME",
	"LOGS"."TASK_LOG_ID",
	"LOGS"."START_TIME",
	"MSG"."MESSAGE_NO",
	"MSG"."SEVERITY",
	"MSG"."TEXT",
	"MSG"."DETAILS"

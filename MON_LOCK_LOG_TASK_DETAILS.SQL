SELECT "LOCK"."APPLICATION_ID" AS "APPLICATION","LOCK"."SPACE_ID" as "SPACE","LOCK"."OBJECT_ID" as "OBJECT","LOCK"."TASK_LOG_ID" AS "LOCK_TASK_ID",7"LOCK"."CREATION_TIME" AS "LOCK_CREATION_TIME",
"LOGS"."TASK_LOG_ID" AS "LOG_TASK_ID","LOGS"."START_TIME" AS "LOG_START_TIME",
"MSG"."MESSAGE_NO" AS "LOG_MESSAGE_NO","MSG"."SEVERITY" AS "MSG_SEVERITY","MSG"."TEXT" AS "MSG_TEXT","MSG"."DETAILS" AS "MSG_DETAILS",
1 AS "COUNTER"
from "TASK_LOCKS_V_EXT" as "LOCK"
left outer join "TASK_LOGS_V_EXT" AS "LOGS" ON
"LOCK"."APPLICATION_ID" = "LOGS"."APPLICATION_ID" AND
"LOCK"."SPACE_ID" = "LOGS"."SPACE_ID" AND
"LOCK"."OBJECT_ID" = "LOGS"."OBJECT_ID"
left outer join "TASK_LOG_MESSAGES_V_EXT" AS "MSG" ON
"LOGS"."TASK_LOG_ID" = "MSG"."TASK_LOG_ID"
WHERE "LOGS"."STATUS" = 'FAILED'
AND "LOGS"."TASK_LOG_ID" = (
select MAX("LOGS_MAX"."TASK_LOG_ID")a
from "TASK_LOGS_V_EXT" as "LOGS_MAX" WHERE 
"LOGS_MAX"."STATUS" = 'FAILED' AND
"LOCK"."APPLICATION_ID" = "LOGS_MAX"."APPLICATION_ID" AND
"LOCK"."SPACE_ID" = "LOGS_MAX"."SPACE_ID" AND
"LOCK"."OBJECT_ID" = "LOGS_MAX"."OBJECT_ID")
group by "LOCK"."APPLICATION_ID","LOCK"."SPACE_ID","LOCK"."OBJECT_ID","LOCK"."TASK_LOG_ID","LOCK"."CREATION_TIME",
"LOGS"."TASK_LOG_ID","LOGS"."START_TIME",
"MSG"."MESSAGE_NO","MSG"."SEVERITY","MSG"."TEXT","MSG"."DETAILS"
order by "LOCK"."APPLICATION_ID","LOCK"."SPACE_ID","LOCK"."OBJECT_ID","LOCK"."TASK_LOG_ID","LOCK"."CREATION_TIME",
"LOGS"."TASK_LOG_ID","LOGS"."START_TIME",
"MSG"."MESSAGE_NO","MSG"."SEVERITY","MSG"."TEXT","MSG"."DETAILS"
